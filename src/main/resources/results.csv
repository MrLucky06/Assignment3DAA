import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.*;

public class GraphAlgorithm {

    static class Edge {
        int from, to, weight;

        public Edge(int from, int to, int weight) {
            this.from = from;
            this.to = to;
            this.weight = weight;
        }
    }

    @JsonIgnoreProperties(ignoreUnknown = true)
    static class GraphInput {
        public List<Graph> graphs;

        public static GraphInput fromJson(String filePath) throws Exception {
            ObjectMapper objectMapper = new ObjectMapper();
            return objectMapper.readValue(new File(filePath), GraphInput.class);
        }

        static class Graph {
            public String id;
            public int nodes;
            public List<Edge> edges;

            @JsonCreator
            public Graph(@JsonProperty("id") String id, @JsonProperty("nodes") int nodes, @JsonProperty("edges") List<Edge> edges) {
                this.id = id;
                this.nodes = nodes;
                this.edges = edges;
            }
        }
    }

    public static void writeResultsToCSV(String algorithm, int totalWeight, long executionTime, int operationCount) {
        try {
            FileWriter writer = new FileWriter("results.csv", true);
            writer.append(algorithm)
                  .append(",")
                  .append(String.valueOf(totalWeight))
                  .append(",")
                  .append(String.valueOf(executionTime))
                  .append(",")
                  .append(String.valueOf(operationCount))
                  .append("\n");
            writer.flush();
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static void prim(int nodes, List<Edge> edges) {
        long startTime = System.currentTimeMillis();
        int totalWeight = 0;
        int operationCount = 0;

        long endTime = System.currentTimeMillis();
        writeResultsToCSV("Prim", totalWeight, endTime - startTime, operationCount);
    }

    public static void kruskal(int nodes, List<Edge> edges) {
        long startTime = System.currentTimeMillis();
        int totalWeight = 0;
        int operationCount = 0;

        long endTime = System.currentTimeMillis();
        writeResultsToCSV("Kruskal", totalWeight, endTime - startTime, operationCount);
    }

    public static void main(String[] args) {
        try {
            GraphInput graphInput = GraphInput.fromJson("src/main/resources/input_data.json");
            for (GraphInput.Graph graph : graphInput.graphs) {
                System.out.println("Processing graph ID: " + graph.id);
                prim(graph.nodes, graph.edges);
                kruskal(graph.nodes, graph.edges);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
